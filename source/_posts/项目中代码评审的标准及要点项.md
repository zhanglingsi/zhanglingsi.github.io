---
title: 项目中代码评审的标准及要点项
categories: 编程
copyright: true
---

# 项目中代码评审的标准及要点项

## 常规检查 

### 命名、注释、声明

     1. 命名规则是否与所采用的规范保持一致？
     2. has/can/is前缀的函数是否返回布尔型？
     3. 注释是否较清晰
     4. 复杂的分支流程是否已经被注释
     5. 函数是否已经有文档注释
     6. 变量是否已经在定义的同时初始化
     7. 类属性是否都执行了初始化

### 语句、功能分布、规模

     1. 单个函数是否执行了单个功能并与其命名相符
     2. 单个函数不超过规定行数（不要超过14行） 
     3. 缩进层数是否不超过规定
<!-- more -->
### 可靠性（变量、语句）

    1. 是否已经消除了所有警告
    2. 常数变量是否声明为final
    3. 对象使用前是否进行了检查
    4. 局部对象变量使用后是否被复位为NULL
    5. 是否确认没有同名变量局部重复定义问题
    6. 所有判断是否都使用了（常量==变量）的形式
    7. 是否每个if-else if-else语句都有最后一个else以确保处理了全集
    8. 对浮点数值的相等判断是否是恰当的？（严禁使用==直接判断）

### 可靠性（函数）

    1. 入口对象是否都被进行了判断不为空
    2. 入口数据的合法范围是否都被进行了判断？(尤其是数组)
    3. 是否对有异常抛出的方法都执行了try...catch保护？
    4. 是否函数的所有分支都有返回值？
    5. 是否对方法返回值对象做了null检查，该返回值定义时是否被初始化?
    6. 是否对同步对象的遍历访问做了代码同步
    7. 是否确认在对Map对象使用迭代遍历过程中没有做增减元素操作
    8. 线程处理函数循环内部是否有异常捕获处理，防止线程抛出异常而退出
    9. 函数对错误的处理是恰当的

### 可维护性
    1. 实现代码中是否消除了直接常量？（用于计数起点的简单常数例外）

## 日志输出
    1. 对于所有接口、方法或函数的入口或返回点，分别打印日志进行标识，并输出入口或返回点的所有参数。
    2. 为便于关联、定位分析日志，涉及参数或数据信息的日志输出行应有唯一标识号，标识号可以是订单号或各类流水号等
    3. 在方法内的逻辑判断点，如if/else等条件判断点，必须打印日志进行标识，并在同一行内，输出所有参数
    4. 多线程应用应将同一个输出点的输出内容打印在同一行，便于后续查证
    5. 如果捕获异常，要在日志输出中，将具体异常内容和相关参数一起打印出来
    6. 在调用外部接口时，需在发起接口调用前和接口返回后，分别输出日志，并输出接口调用前和返回后的相关参数
    7. 对外提供的服务或接口，应在被调用后，输出调用方的IP地址
    8. 管理类应用如综管台、业管系统等，需将登录用户名在日志中进行输出。
    9. 涉及银行卡号、密码、身份证号等敏感信息的不允许在日志中进行输出，如确因业务或查证需要必须输出到日志中的，需报研发中心安全管理员审核批准，并对敏感信息的中间部分数据位用类似***的掩码输出
    10. 涉及银行卡号、密码、身份证号等敏感信息的不允许在日志中进行输出，如确因业务或查证需要必须输出到日志中的，需报研发中心安全管理员审核批准，并对敏感信息的中间部分数据位用类似***的掩码输出

## 代码审核 checklist
    1. 硬编码  （不变更的内容放置在配置文件或常量类中）
    2. 方法命名随意  （贴切功能）
    3. 注释不清楚  （class注释，函数注释，变量注释）
    4. 日志输出，级别定义  （错误信息用error,基本信息用debug，稳定之后可以不需要再打印。需要查证信息用Info。前端接入模块，每行日志输出都必须加上订单号和订单请求流水号。银行模块，每行日志都必须加上平台流水和银行请求流水。业务模块，每行日志都必须加上平台流水和业务请求流水。 其它模块，每行日志加上平台流水。）
    5. 工具类重复制造 （common中的工具类，以及开源工具类）
    6. 简化if结构  （if中判断失败结果，成功不需要else）
    7. 静态块的走查  （静态变量，静态方法使用）
    8. response对象使用  （模块之间的调用返回此对象。issuccess成功，里面的范型必须有值）
    9. 异常处理  （每个模块的入口去捕获异常，模块内的调用不去try，catch，直接抛给入口。函数内有调用外部接口时，需要try，catch。）

## 代码评审意见稿

|评审内容|评审人员|时间|审核问题|解决方案|遗留问题
|:------|:------|:------|:------|:------|:------|
|工单号+业务名称|张三，李四等|2018-08-18|1:硬编码2:方法命名随意3:注释不够详细4:日志输出没有依据,无法给运维人员很好查找错误5:工具类重复制造|空|异常机制建立，错误码规范


